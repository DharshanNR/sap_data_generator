
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>SAP Data Quality Dashboard</title>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
            <style>
                body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f7f6; color: #333; }
                .container { max-width: 1200px; margin: auto; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
                h1, h2, h3 { color: #0056b3; }
                .summary-card { background-color: #e9ecef; border-left: 5px solid #007bff; padding: 15px; margin-bottom: 15px; border-radius: 5px; }
                .summary-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
                .summary-item { background-color: #f8f9fa; padding: 15px; border-radius: 5px; text-align: center; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
                .summary-item h3 { margin-top: 0; font-size: 1.2em; color: #555; }
                .summary-item p { font-size: 1.8em; font-weight: bold; margin: 5px 0; }
                .status-PASS { color: #28a745; }
                .status-FAIL { color: #dc3545; }
                .status-WARNING { color: #ffc107; }
                .severity-Critical { background-color: #f8d7da; color: #721c24; border-left: 5px solid #dc3545; }
                .severity-Warning { background-color: #fff3cd; color: #856404; border-left: 5px solid #ffc107; }
                .severity-Info { background-color: #d1ecf1; color: #0c5460; border-left: 5px solid #17a2b8; }
                table { width: 100%; border-collapse: collapse; margin-top: 15px; }
                th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                th { background-color: #007bff; color: white; }
                .accordion { background-color: #eee; color: #444; cursor: pointer; padding: 18px; width: 100%; text-align: left; border: none; outline: none; transition: 0.4s; font-size: 1.1em; margin-top: 10px; }
                .active, .accordion:hover { background-color: #ccc; }
                .panel { padding: 0 18px; background-color: white; max-height: 0; overflow: hidden; transition: max-height 0.2s ease-out; }
                .chart-container { width: 48%; display: inline-block; margin: 1%; vertical-align: top; }
                .chart-row { display: flex; flex-wrap: wrap; justify-content: space-between; margin-bottom: 20px; }
            </style>
        </head>
        <body>
            <div class="container">
                <h1>SAP Data Quality Dashboard</h1>
                <p>Generated on: 2025-12-04 12:27:16</p>

                <div class="summary-card">
                    <h2>Overall Data Quality Score: <span style="font-size: 2em; color: #28a745">93.43/100</span></h2>
                </div>

                <h2>Summary Dashboard</h2>
                <div class="summary-grid">
                    <div class="summary-item"><h3>Total Checks</h3><p>23</p></div>
                    <div class="summary-item status-PASS"><h3>Passed Checks</h3><p>19</p></div>
                    <div class="summary-item status-FAIL"><h3>Failed Checks</h3><p>2</p></div>
                    <div class="summary-item status-WARNING"><h3>Warning Checks</h3><p>1</p></div>
                    <div class="summary-item severity-Critical"><h3>Critical Issues</h3><p>2</p></div>
                    <div class="summary-item severity-Warning"><h3>Warning Issues</h3><p>1</p></div>
                    <div class="summary-item severity-Info"><h3>Info Issues</h3><p>1</p></div>
                </div>

                <h2>Data Profile</h2>
                <h3>Record Counts</h3>
                <table>
                    <thead><tr><th>Table</th><th>Records</th></tr></thead>
                    <tbody>
                        <tr><td>LFA1</td><td>10</td></tr><tr><td>MARA</td><td>500</td></tr><tr><td>EKKO</td><td>100</td></tr><tr><td>EKPO</td><td>400</td></tr><tr><td>EKBE</td><td>300</td></tr><tr><td>VENDOR_CONTRACTS</td><td>200</td></tr>
                    </tbody>
                </table>
                <h3>Date Range Coverage</h3>
                <table>
                    <thead><tr><th>Field</th><th>Min Date</th><th>Max Date</th></tr></thead>
                    <tbody>
                        <tr><td>LFA1.ERDAT</td><td>2020-07-28</td><td>2024-04-03</td></tr><tr><td>MARA.ERSDA</td><td>2020-01-02</td><td>2024-12-28</td></tr><tr><td>EKKO.AEDAT</td><td>2020-04-07</td><td>2024-12-23</td></tr><tr><td>EKKO.BEDAT</td><td>2020-04-07</td><td>2024-12-23</td></tr><tr><td>EKPO.EINDT</td><td>2020-04-23</td><td>2025-02-15</td></tr><tr><td>EKBE.BUDAT</td><td>2020-06-11</td><td>2025-03-19</td></tr><tr><td>VENDOR_CONTRACTS.VALID_FROM</td><td>2020-01-01</td><td>2024-08-12</td></tr><tr><td>VENDOR_CONTRACTS.VALID_TO</td><td>2020-01-27</td><td>2026-12-30</td></tr>
                    </tbody>
                </table>
                <h3>Distribution Statistics</h3>
                <ul>
                    <li><strong>Top 10 Vendors by Spend:</strong> {'V0000002': 657611810.21, 'V0000001': 470382238.02, 'V0000010': 115256599.21, 'V0000009': 97951667.41, 'V0000003': 45801027.69, 'V0000008': 26715037.36, 'V0000007': 14464006.2, 'V0000005': 9502319.86, 'V0000004': 8353229.58}</li>
                    <li><strong>Spend by Material Category:</strong> {'Electronics': 272582337.08, 'Office Supplies': 11127156.03, 'Raw Materials': 140276147.68, 'Services': 1022052294.75}</li>
                    <li><strong>Materials by Category:</strong> {'Electronics': 135, 'Office Supplies': 131, 'Services': 118, 'Raw Materials': 116}</li>
                    <li><strong>Average Items per PO:</strong> 4.17</li>
                    <li><strong>Max Items per PO:</strong> 12</li>
                    <li><strong>Average EKBE records per EKPO item:</strong> 3.95</li>
                    <li><strong>Max EKBE records per EKPO item:</strong> 6</li>
                </ul>

                <h2>Detailed Findings</h2>
                <button class="accordion">Referential Integrity</button><div class="panel">
            <div class="summary-card severity-Info">
                <h3>EKPO.EBELN in EKKO <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All EKPO.EBELN exist in EKKO.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>EKKO.LIFNR in LFA1 <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All EKKO.LIFNR exist in LFA1.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>EKPO.MATNR in MARA <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All EKPO.MATNR exist in MARA.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>EKBE.EBELN+EBELP in EKPO <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All EKBE.EBELN+EBELP exist in EKPO.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>VENDOR_CONTRACTS.LIFNR in LFA1 <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All VENDOR_CONTRACTS.LIFNR exist in LFA1.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>VENDOR_CONTRACTS.MATNR in MARA <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All VENDOR_CONTRACTS.MATNR exist in MARA.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            </div><button class="accordion">Business Logic Validation</button><div class="panel">
            <div class="summary-card severity-Info">
                <h3>EKPO.NETWR Calculation <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All EKPO.NETWR calculations are correct.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Delivery Date vs PO Date <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All delivery dates are after PO dates.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Contract PO Price Adherence <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> Contract PO prices adhere to contract terms.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Invoice vs GR Amount Match <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> Invoice amounts match GR amounts.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Contract Date Validity <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All contract dates are valid.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Invoice Date After GR Date <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> All invoice dates are after goods receipt dates.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Blocked Vendors Recent POs <span class="status-INFO">(INFO)</span></h3>
                <p><strong>Description:</strong> No blocked vendors found.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            </div><button class="accordion">Statistical Validation</button><div class="panel">
            <div class="summary-card severity-Info">
                <h3>Price Outliers by Material Category <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> No significant price outliers detected.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Warning">
                <h3>Vendor Spend Pareto Principle <span class="status-WARNING">(WARNING)</span></h3>
                <p><strong>Description:</strong> Pareto principle check failed: Top 20% vendors account for 45.48% of spend, expected ~80% (±10.0%).</p>
                <p><strong>Violations:</strong> 1 (100.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Contract Compliance Rate <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> Contract compliance rate is within expected range.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Late Delivery Rate <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> Late delivery rate is within expected range.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>GR to Invoice Ratio <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> GR to Invoice ratio is within expected range.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            </div><button class="accordion">Completeness Checks</button><div class="panel">
            <div class="summary-card severity-Critical">
                <h3>PO with Line Items <span class="status-FAIL">(FAIL)</span></h3>
                <p><strong>Description:</strong> Some Purchase Orders (EKKO) have no corresponding line items (EKPO).</p>
                <p><strong>Violations:</strong> 4 (4.0%)</p>
                <p><strong>Examples:</strong> PO0000000097, PO0000000098, PO0000000099, PO0000000100</p>
            </div>
            
            <div class="summary-card severity-Critical">
                <h3>PO Line Item with GR <span class="status-FAIL">(FAIL)</span></h3>
                <p><strong>Description:</strong> Some PO line items (EKPO) have no corresponding Goods Receipt (EKBE BEWTP='E').</p>
                <p><strong>Violations:</strong> 324 (81.0%)</p>
                <p><strong>Examples:</strong> ('PO0000000020', 'LI00002'), ('PO0000000020', 'LI00003'), ('PO0000000021', 'LI00001'), ('PO0000000021', 'LI00002'), ('PO0000000021', 'LI00003')</p>
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Material Group Balance <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> Material groups are balanced.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Overall Date Range <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> Overall data date range is correct.</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            
            <div class="summary-card severity-Info">
                <h3>Valid Currency Codes <span class="status-PASS">(PASS)</span></h3>
                <p><strong>Description:</strong> Currency codes are validated by schema check (EKKO.WAERS).</p>
                <p><strong>Violations:</strong> 0 (0.0%)</p>
                
            </div>
            </div>

                <h2>Visualizations</h2>
                <div class="chart-row">
                    <div class="chart-container"><canvas id="spendDistributionChart"></canvas></div>
                    <div class="chart-container"><canvas id="deliveryPerformanceChart"></canvas></div>
                </div>
                <div class="chart-row">
                    <div class="chart-container"><canvas id="priceVarianceChart"></canvas></div>
                    <div class="chart-container"><canvas id="materialCompletenessChart"></canvas></div>
                </div>

            </div>
            <script>
                var acc = document.getElementsByClassName("accordion");
                var i;
                for (i = 0; i < acc.length; i++) {
                    acc[i].addEventListener("click", function() {
                        this.classList.toggle("active");
                        var panel = this.nextElementSibling;
                        if (panel.style.maxHeight) {
                            panel.style.maxHeight = null;
                        } else {
                            panel.style.maxHeight = panel.scrollHeight + "px";
                        } 
                    });
                }
                
            new Chart(document.getElementById('spendDistributionChart'), {
                type: 'bar',
                data: {
                    labels: ["Electronics", "Office Supplies", "Raw Materials", "Services"],
                    datasets: [{
                        label: 'Total Spend',
                        data: [272582337.08, 11127156.03, 140276147.68, 1022052294.75],
                        backgroundColor: ['#007bff', '#28a745', '#ffc107', '#dc3545'],
                        borderColor: ['#007bff', '#28a745', '#ffc107', '#dc3545'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { title: { display: true, text: 'Spend Distribution by Material Category' } },
                    scales: { y: { beginAtZero: true, title: { display: true, text: 'Spend ($)' } } }
                }
            });
            

                    new Chart(document.getElementById('deliveryPerformanceChart'), {
                        type: 'pie',
                        data: {
                            labels: ['On-Time', 'Late'],
                            datasets: [{
                                data: [120, 30],
                                backgroundColor: ['#28a745', '#dc3545'],
                                hoverOffset: 4
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: { title: { display: true, text: 'Delivery Performance' } }
                        }
                    });
                    

                new Chart(document.getElementById('priceVarianceChart'), {
                    type: 'bar',
                    data: {
                        labels: ["-100.0-2625.8%", "2625.8-5351.6%", "5351.6-8077.3%", "8077.3-10803.1%", "10803.1-13528.9%", "13528.9-16254.6%", "16254.6-18980.4%", "18980.4-21706.1%", "21706.1-24431.9%", "24431.9-27157.7%", "27157.7-29883.4%", "29883.4-32609.2%", "32609.2-35334.9%", "35334.9-38060.7%", "38060.7-40786.5%", "40786.5-43512.2%", "43512.2-46238.0%", "46238.0-48963.8%", "48963.8-51689.5%", "51689.5-54415.3%"],
                        datasets: [{
                            label: 'Price Variance (%)',
                            data: [357, 15, 7, 6, 3, 2, 5, 2, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1],
                            backgroundColor: 'rgba(75, 192, 192, 0.6)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: { title: { display: true, text: 'Price Variance Distribution (vs Base Price)' } },
                        scales: {
                            x: { title: { display: true, text: 'Variance (%)' } },
                            y: { beginAtZero: true, title: { display: true, text: 'Number of Items' } }
                        }
                    }
                });
                

            new Chart(document.getElementById('materialCompletenessChart'), {
                type: 'bar',
                data: {
                    labels: ["EKBE.ACTUAL_DELIVERY_DATE"],
                    datasets: [{
                        label: 'Null Percentage',
                        data: [50.0],
                        backgroundColor: 'rgba(255, 99, 132, 0.6)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { title: { display: true, text: 'Null Value Completeness by Field' } },
                    scales: {
                        x: { ticks: { autoSkip: false, maxRotation: 45, minRotation: 45 } },
                        y: { beginAtZero: true, max: 100, title: { display: true, text: 'Null %' } }
                    }
                }
            });
            
            </script>
        </body>
        </html>
        